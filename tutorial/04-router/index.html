<!doctype html>
<html>
  <head>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tutorial Part 4: The Curi router | Curi Documentation</title>
    <link href="https://fonts.googleapis.com/css?family=Zilla+Slab:300,400" rel="stylesheet">
    <link href="/static/css/index.css" rel="stylesheet">
  </head>
  <body>
    <div id="root"><div data-reactroot=""><header><nav><ul><li><a class="home-link" href="/">Curi</a></li><li><a href="/packages">Packages</a></li><li><a class="active" href="/tutorial">Tutorial</a></li><li><a href="/guides">Guides</a></li><li><a href="/examples">Examples</a></li><li><a href="https://github.com/pshrmn/curi">GitHub</a></li></ul></nav></header><main><div class="tutorial"><div class="content"><h1>Part 4: The Curi Router</h1><p>Curi uses a centralized router to handle routing. Essentially, whenever the location changes (and when your application first loads), the router will iterate over your routes to find one that matches the location. Then, it will use that route to generate a response object. This response contains a bunch of properties that are useful for rendering your application.</p><div class="tutorial-outline"><p>In this tutorial, we will be doing the following:</p><ul><li>Creating a Curi router using our routes and history object.</li><li>Learning about some of the properties of the router and how Curi works.</li></ul></div><div class="tutorial-branch"><p>If you are following along using the<!-- --> <a href="https://github.com/pshrmn/curi-tutorial">tutorial repo</a>, please checkout the <code class="language-javascript">04-router</code> branch.</p><pre><code class="language-bash">git checkout 04-router</code></pre></div><div class="aside" id="installation"><h2>Installation<a class="header-link" href="/tutorial/04-router#installation">#</a></h2><p>If you skipped the setup, you should install <code class="language-javascript">@curi/core</code> now.</p><pre><code class="language-bash">npm install @curi/core</code></pre></div><div class="section" id="create"><h2>Creating our router<a class="header-link" href="/tutorial/04-router#create">#</a></h2><p><code class="language-javascript">@curi/core</code> only has a single, default export, which is a function that will create a router. In this tutorial, we will import it as <code class="language-javascript">curi</code> (of course, you can name it whatever you like).</p><pre><code class="language-javascript">import curi from &#x27;@curi/core&#x27;;</code></pre><p><code class="language-javascript">curi</code> can take three arguments; the first two arguments are required while the third is not.</p><ol><li><code class="language-javascript">history</code> - The first argument to pass to <code class="language-javascript">curi</code> is a Hickory history object.</li><li><code class="language-javascript">routes</code> - The second argument is an array of route objects.</li><li><code class="language-javascript">options</code> - The third argument is an object that contains additional configuration options. We will not be using this object in this tutorial.</li></ol><p>Using the routes that we defined in the<!-- --> <a href="/tutorial/02-routes">Routes Tutorial</a> <!-- -->and the<!-- --> <a href="/tutorial/03-hickory">Hickory history object</a>, we are ready to create our router.</p><pre><code class="language-javascript">// src/index.js
import curi from &#x27;@curi/core&#x27;;
import Browser from &#x27;@hickory/browser&#x27;;

import routes from &#x27;./routes&#x27;;

const history = Browser();
const router = curi(history, routes);</code></pre></div><div class="aside" id="observer"><h2>Observer Model<a class="header-link" href="/tutorial/04-router#observer">#</a></h2><p>In order to let your application know about location changes, Curi uses an observer model to emit responses. A piece of code that wants to know about the current response passes a callback function (referred to here as a response handler) to <code class="language-javascript">router.respond</code>. If a response already exists, then the response handler will be called immediately. If the initial response hasn&#x27;t resolved, then the response handler will be called once it does.</p><p>What does a response handler function look like? It receives an object with three properties: <code class="language-javascript">response</code>, <code class="language-javascript">navigation</code>, and<!-- --> <code class="language-javascript">router</code>. The <code class="language-javascript">response</code> contains information about the route that matched the new location, the <code class="language-javascript">navigation</code> <!-- -->contains navigation data that doesn&#x27;t belong in a <code class="language-javascript">response</code>, and the <code class="language-javascript">router</code> is your Curi router.</p><pre><code class="language-javascript">function responseLogger({ response, navigation, router }) {
  console.log(&quot;[response]&quot;, response);
  console.log(&quot;[navigation]&quot;, navigation);
  console.log(&quot;[router]&quot;, router);
}
router.respond(responseLogger);</code></pre><div class="note"><strong>Note:</strong> <!-- -->By default, the response handler will only be called one time. However, your application should be updated for <em>every</em> response.<!-- --> <code class="language-javascript">router.respond</code> supports a second argument, which is an options object. One of these options is <code class="language-javascript">observe</code>.<!-- --> <code class="language-javascript">observe</code> defaults to <code class="language-javascript">false</code>, but when you set it to<!-- --> <code class="language-javascript">true</code>, the response handler will be called every time a new response is emitted. This will also return a function so that you can stop observing. You probably won&#x27;t need to use this because the various packages (<code class="language-javascript">@curi/react</code>, <code class="language-javascript">@curi/vue</code>, etc. handle this for you).<pre><code class="language-javascript">function responseLogger() {
    console.log(&quot;I will be called for every response&quot;);
  }
  const stopResponding = router.respond(
    responseLogger,
    { observe: true }
  );
  // any navigation that happens now will be logged
  // ...
  stopResponding();
  // after unsubscribing, any new navigation will not be logged</code></pre></div></div><div class="section" id="review"><h2>Review<a class="header-link" href="/tutorial/04-router#review">#</a></h2><p>If you are following the React path:</p><div class="tutorial-branch"><p>You can view the completed source code for this tutorial<!-- --> <a href="https://github.com/pshrmn/curi-tutorial/tree/05-pages-react">on GitHub</a>.</p></div><p>If you are following the Vue path:</p><div class="tutorial-branch"><p>You can view the completed source code for this tutorial<!-- --> <a href="https://github.com/pshrmn/curi-tutorial/tree/05-pages-vue">on GitHub</a>.</p></div></div><div class="section" id="next"><h2>Next<a class="header-link" href="/tutorial/04-router#next">#</a></h2><p>With our router created, we are finally ready to render. Now, we are at a bit of a fork in the road. While most of the tutorials apply to everyone, the next tutorial is framework specific.</p><p>If you are following along using React, continue on to<!-- --> <a href="/tutorial/05-pages-react">Part 6: React Pages</a></p><p>If you are following along using Vue, you instead you should go to<!-- --> <a href="/tutorial/05-pages-vue">Part 6: Vue Pages</a></p></div></div><div class="sidebar"><h2>Tutorials</h2><ul class="link-list"><li class="solo"><a href="/tutorial/01-setup">Part 1: Curi Setup</a></li><li class="solo"><a href="/tutorial/02-routes">Part 2: Curi Routes</a></li><li class="solo"><a href="/tutorial/03-hickory">Part 3: Hickory</a></li><li class="solo"><a class="active" href="/tutorial/04-router">Part 4: The Curi router</a></li><li class="solo"><p>Part 5: Rendering Pages</p><ul class="frameworks"><li><a href="/tutorial/05-pages-react">react</a></li><li><a href="/tutorial/05-pages-vue">vue</a></li></ul></li><li class="solo"><a href="/tutorial/06-loading-data">Part 6: Loading Data</a></li><li class="solo"><p>Part 7: Rendering Data</p><ul class="frameworks"><li><a href="/tutorial/07-render-data-react">react</a></li><li><a href="/tutorial/07-render-data-vue">vue</a></li></ul></li><li class="solo"><p>Part 8: Forms &amp; Programmatic Navigation</p><ul class="frameworks"><li><a href="/tutorial/08-nav-react">react</a></li><li><a href="/tutorial/08-nav-vue">vue</a></li></ul></li><li class="solo"><a href="/tutorial/09-now-what">Part 9: Now What?</a></li></ul></div></div></main></div></div>
    <script src="https://unpkg.com/react@16.0.0/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@16.0.0/umd/react-dom.production.min.js"></script>
    <script src="/static/js/prism.js"></script>
    <script src="/static/js/bundle.js"></script>
  </body>
</html>
