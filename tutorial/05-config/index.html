<!doctype html>
<html>
  <head>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tutorial Part 5: The Curi Configuration Object | Curi Documentation</title>
    <link href="https://fonts.googleapis.com/css?family=Zilla+Slab:300,400" rel="stylesheet">
    <link href="/static/css/index.css" rel="stylesheet">
  </head>
  <body>
    <div id="root"><div data-reactroot=""><header><nav><ul><li><a class="home-link" href="/">Curi</a></li><li><a href="/packages">Packages</a></li><li><a href="/tutorial/01-introduction">Tutorial</a></li><li><a href="/guides/getting-started/">Guides</a></li><li><a href="/examples">Examples</a></li><li><a href="https://github.com/pshrmn/curi">GitHub</a></li></ul></nav></header><main><div class="tutorial"><div class="content"><h1>Part 5: The Curi Configuration Object</h1><p>Curi uses a centralized configuration object to handle routing. Essentially, whenever the location changes (and when your application first loads), the configuration object will iterate over your routes to find one that matches the location. Then, it will use that route to generate a response object. This response contains a bunch of properties that are useful for rendering your application.</p><div><p>In this tutorial, we will be doing the following:</p><ul><li>Creating a Curi configuration object using our routes and history object.</li><li>Learning about some of the properties of the configuration object and how Curi works.</li></ul></div><div class="aside"><h2 id="installation">Installation<a class="header-link" href="/tutorial/05-config#installation">#</a></h2><p>If you skipped the setup, you should install <code class="language-javascript">@curi/core</code> now.</p><pre class="language-bash">npm install @curi/core</pre></div><div class="section"><h2 id="create">Creating our Config<a class="header-link" href="/tutorial/05-config#create">#</a></h2><p><code class="language-javascript">@curi/core</code> only has a single, default export, which is a function that will create a configuration object. In this tutorial, we will import it as <code class="language-javascript">createConfig</code> (of course, you can name it whatever you like).</p><pre class="language-javascript">import createConfig from &#x27;@curi/core&#x27;;</pre><p><code class="language-javascript">createConfig</code> can take three arguments; the first two arguments are required while the third is not.</p><ol><li><code class="language-javascript">history</code> - The first argument to pass to <code class="language-javascript">createConfig</code> <!-- -->is a Hickory history object.</li><li><code class="language-javascript">routes</code> - The second argument is an array of route objects.</li><li><code class="language-javascript">config</code> - The third argument is an object that contains additional configuration data. We will not be using this object in this tutorial.</li></ol><p>Using the routes that we defined in the<!-- --> <a href="/tutorial/03-routes">Routes Tutorial</a> <!-- -->and the<!-- --> <a href="/tutorial/04-hickory">Hickory history object</a>, we are ready to create our configuration object.</p><pre class="language-javascript">import createConfig from &#x27;@curi/core&#x27;;
import Browser from &#x27;@hickory/browser&#x27;;

import routes from &#x27;./routes&#x27;;

const history = Browser();
const config = createConfig(history, routes);</pre></div><p>There are two more things we should cover before we&#x27;re ready to render. The first is how your application knows that navigation has happened so that it can re-render. The second is something that we haven&#x27;t seen any evidence of it yet, but will become important soon: Curi is an asynchronous router.</p><div class="aside"><h2 id="subscriber">Subscriber Model<a class="header-link" href="/tutorial/05-config#subscriber">#</a></h2><p>In order to let your application know about location changes, Curi uses a subscriber model. Whenever a location change happens, Curi will create a new response and then emit this response to all of its subscribed methods. Using <code class="language-javascript">config.subscribe</code>, we can give Curi a subscriber method to call when a new response has been created.</p><p>What does a subscriber function look like? It can take two arguments. The first will be the <code class="language-javascript">response</code> object generated for the new location. The second is the <code class="language-javascript">action</code>type from the navigation (<code class="language-javascript">&#x27;PUSH&#x27;</code>,<code class="language-javascript">&#x27;POP&#x27;</code>, and <code class="language-javascript">&#x27;REPLACE&#x27;</code>).</p><pre class="language-javascript">function responseLogger(response, action) {
  console.log(&quot;RESPONSE:&quot;, response);
  console.log(&quot;ACTION&quot;, action)
}
config.subscribe(responseLogger);</pre></div><div class="aside"><h2 id="ready">Ready or Not<a class="header-link" href="/tutorial/05-config#ready">#</a></h2><p>Curi being asynchronous means that we can run async code (e.g. code splitting using <code class="language-javascript">import()</code> or data fetching using <code class="language-javascript">fetch()</code>) prior to emitting a response. This is really convenient, but it can also be a gotcha if you are not aware of it.</p><p>The reason that you need to be aware of it is because of what happens when you create your configuration object. When you do this, Curi will begin creating a response for you using the initial location (in a browser, this will be the current URI). However, we will not be able to access the initial response right after we create our config object. Instead, we will need to use the <code class="language-javascript">config.ready</code> <!-- -->method to wait for our initial response to be ready.</p><pre class="language-javascript">const config = createConfig(history, routes);
config.ready().then(resp =&gt; {
  // this function won&#x27;t be called until the Promise returned
  // by config.ready() has resolved with our response object
  console.log(&quot;Houston, we have a response&quot;, resp);
});
// since Curi is async, other parts of our code can continue
// to run while we wait for the response to be ready
// this code will be run before code inside of the then function
console.log(&quot;Look, Ma, no response yet!&quot;);</pre><p>Calling <code class="language-javascript">config.ready()</code> returns a <code class="language-javascript">Promise</code> that resolves with our response object. It isn&#x27;t absolutely mandatory that you use <code class="language-javascript">config.ready()</code>, but if you do not, you will need to handle rendering when the response is <code class="language-javascript">undefined</code>.</p></div><div class="section"><h2 id="next">Next<a class="header-link" href="/tutorial/05-config#next">#</a></h2><p>With our configuration object created, we are finally ready to render. Now, we are at a bit of a fork in the road. While most of the tutorials apply to everyone, the next tutorial is framework specific.</p><p>If you are following along using React, continue on to<!-- --> <a href="/tutorial/06-pages-react">Part 6: React Pages</a></p><p>If you are following along using Vue, you instead you should go to<!-- --> <a href="/tutorial/06-pages-vue">Part 6: Vue Pages</a></p></div></div><div class="sidebar"><h2>Tutorials</h2><ul class="link-list"><li class="solo"><a href="/tutorial/01-introduction">Part 1: Introduction to Curi</a></li><li class="solo"><a href="/tutorial/02-setup">Part 2: Curi Setup</a></li><li class="solo"><a href="/tutorial/03-routes">Part 3: Curi Routes</a></li><li class="solo"><a href="/tutorial/04-hickory">Part 4: Hickory</a></li><li class="solo"><a class="active" href="/tutorial/05-config">Part 5: The Curi Configuration Object</a></li><li class="solo"><p>Part 6: Rendering Pages</p><ul class="frameworks"><li><a href="/tutorial/06-pages-react">react</a></li><li><a href="/tutorial/06-pages-vue">vue</a></li></ul></li><li class="solo"><a href="/tutorial/07-load">Part 7: The Load Function</a></li><li class="solo"><p>Part 8: Rendering Data</p><ul class="frameworks"><li><a href="/tutorial/08-render-data-react">react</a></li><li><a href="/tutorial/08-render-data-vue">vue</a></li></ul></li><li class="solo"><p>Part 9: Forms &amp; Programmatic Navigation</p><ul class="frameworks"><li><a href="/tutorial/09-nav-react">react</a></li><li><a href="/tutorial/09-nav-vue">vue</a></li></ul></li><li class="solo"><a href="/tutorial/10-now-what">Part 10: Now What?</a></li></ul></div></div></main></div></div>
    <script src="https://unpkg.com/react@16.0.0/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@16.0.0/umd/react-dom.production.min.js"></script>
    <script src="/static/js/prism.js"></script>
    <script src="/static/js/bundle.js"></script>
  </body>
</html>
