<!doctype html>
<html>
  <head>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Code Splitting Guide | Curi Documentation</title>
    <link href="https://fonts.googleapis.com/css?family=Zilla+Slab:300,400" rel="stylesheet">
    <link href="/static/css/index.css" rel="stylesheet">
  </head>
  <body>
    <div id="root"><div data-reactroot=""><header><nav><ul><li><a class="home-link" href="/">Curi</a></li><li><a href="/packages">Packages</a></li><li><a href="/tutorial/01-introduction">Tutorial</a></li><li><a href="/guides/getting-started/">Guides</a></li><li><a href="/examples">Examples</a></li><li><a href="https://github.com/pshrmn/curi">GitHub</a></li></ul></nav></header><main><div class="guide"><div class="content"><h1>Code Splitting</h1><p>If you are bundling an application with a lot of routes, users of your application may be downloading a lot of unnecessary content just to render the initial page. Using code splitting, you can reduce the initial download size for your application by splitting code that is conditionally loaded into a separate bundle that is only downloaded when it is needed.</p><div class="note"><strong>Note:</strong> <!-- -->This guide assumes that you are using Webpack 2+ to bundle your application.</div><div class="section"><h2 id="no-split">An app without code splitting<a class="header-link" href="/guides/code-splitting/#no-split">#</a></h2><p>Let&#x27;s start out by describing our application&#x27;s routes without code splitting. We will import each route&#x27;s component from the files where they are defined.</p><pre class="language-javascript">import Home from &#x27;./components/Home&#x27;;
import Contact from &#x27;./components/Contact&#x27;;
import ContactMethod from &#x27;./components/ContactMethod&#x27;;

const routes = [
  {
    name: &#x27;Home&#x27;,
    path: &#x27;&#x27;,
    match: () =&gt; {
      response: ({ set }) =&gt; {
        set.body(Home);
      }
    }
  },
  {
    name: &#x27;Contact&#x27;,
    path: &#x27;contact&#x27;,
    match: () =&gt; {
      response: ({ set }) =&gt; {
        set.body(Contact);
      }
    },
    children: [
      {
        name: &#x27;Contact Method&#x27;,
        path: &#x27;:method&#x27;,
        match: () =&gt; {
          response: ({ set }) =&gt; {
            set.body(ContactMethod);
          }
        }
      }
    ]
  }
];</pre></div><div class="section"><h2 id="initial">import() in match.initial<a class="header-link" href="/guides/code-splitting/#initial">#</a></h2><p>Instead of having static imports, we will use the <code class="language-javascript">import()</code> <!-- -->function to import our modules. We will import our components using the <code class="language-javascript">match.initial</code> property of routes. This function will only be called the first time that its route matches, so we don&#x27;t have to worry about making extra requests to our server.</p><p><code class="language-javascript">match.initial</code> should be a function that returns a Promise;<!-- --> <code class="language-javascript">import()</code>, conveniently, returns a Promise. Then, in our<!-- --> <code class="language-javascript">match.response</code> function, instead of referencing values imported at the top of the file, we can reference the result of the <code class="language-javascript">initial</code> <!-- -->function using <code class="language-javascript">resolved.initial</code>.</p><p><code class="language-javascript">import()</code> resolves with a module object, so we will just assume that the component are default imports and reference them as<!-- --> <code class="language-javascript">resolved.initial.default</code>. Alternatively, we could just resolve the default value in our <code class="language-javascript">match.initial</code> function.</p><pre class="language-javascript">const routes = [
  {
    name: &#x27;Home&#x27;,
    path: &#x27;&#x27;,
    match: {
      initial: () =&gt; import(&#x27;./components/Home&#x27;),
      response: ({ resolved, set }) =&gt; {
        set.body(resolved.initial.default);
      }
    },
    body: () =&gt; Home
  },
  {
    name: &#x27;Contact&#x27;,
    path: &#x27;contact&#x27;,
    match: {
      initial: () =&gt; import(&#x27;./components/Contact&#x27;),
      response: ({ resolved, set }) =&gt; {
        set.body(resolved.initial.default);
      }
    },
    body: () =&gt; Contact,
    children: [
      {
        name: &#x27;Contact Method&#x27;,
        path: &#x27;:method&#x27;,
        match: {
          // we can resolve module.default in initial
          // instead of in response
          initial: () =&gt; import(&#x27;./components/ContactMethod&#x27;)
            .then(module =&gt; module.default),
            response: ({ resolved, set }) =&gt; {
            set.body(resolved.initial);
          }
        },
        body: () =&gt; ContactMethod
      }
    ]
  }
];</pre></div><div class="section"><h2 id="next">Next<a class="header-link" href="/guides/code-splitting/#next">#</a></h2><p>The approaches taken here are not the only way to do code splitting. You may choose to skip the <code class="language-javascript">match.initial</code> method and do code splitting at other points in your application. Whatever path you decide to go, hopefully this has shown you that setting up code splitting with the <code class="language-javascript">match.initial</code> <!-- -->property is fairly simple to do. If you are using Webpack and want to reduce your initial bundle size, <code class="language-javascript">match.initial</code> is an easy way to accomplish this.</p><p>Next, we will take a look at some related route properties in<!-- --> <a href="/guides/loading/">the loading guide</a>.</p></div></div><div class="sidebar"><h2>Guides</h2><ul><li class="link-group"><h3>basic</h3><ul class="link-list"><li class="solo"><a href="/guides/installation/">Installation</a></li><li class="solo"><a href="/guides/getting-started/">Getting Started</a></li><li class="solo"><a href="/guides/routes/">All About Routes</a></li><li class="solo"><a href="/guides/responses/">Rendering with Responses</a></li></ul></li><li class="link-group"><h3>advanced</h3><ul class="link-list"><li class="solo"><a href="/guides/addons/">Using Addons</a></li><li class="solo"><a href="/guides/side-effects/">Using Side Effects</a></li><li class="solo"><a href="/guides/response-caching/">Response Caching</a></li><li class="solo"><a class="active" href="/guides/code-splitting/">Code Splitting</a></li><li class="solo"><a href="/guides/loading/">Loading Route Data</a></li><li class="solo"><a href="/guides/react/">React Basics</a></li></ul></li><li class="link-group"><h3>migration</h3><ul class="link-list"><li class="solo"><a href="/guides/migrate-rrv3/">Migrate from React Router v2/3 to Curi</a></li></ul></li></ul></div></div></main></div></div>
    <script src="https://unpkg.com/react@16.0.0/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@16.0.0/umd/react-dom.production.min.js"></script>
    <script src="/static/js/prism.js"></script>
    <script src="/static/js/bundle.js"></script>
  </body>
</html>
