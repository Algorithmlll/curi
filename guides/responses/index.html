<!doctype html>
<html>
  <head>
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rendering with Responses Guide | Curi Documentation</title>
    <link href="https://fonts.googleapis.com/css?family=Zilla+Slab:300,400" rel="stylesheet">
    <link href="/static/css/index.css" rel="stylesheet">
  </head>
  <body>
    <div id="root"><div data-reactroot=""><header><nav><ul><li><a class="home-link" href="/">Curi</a></li><li><a href="/packages">Packages</a></li><li><a href="/tutorial/01-introduction">Tutorial</a></li><li><a href="/guides/getting-started/">Guides</a></li><li><a href="/examples">Examples</a></li><li><a href="https://github.com/pshrmn/curi">GitHub</a></li></ul></nav></header><main><div class="guide"><div class="content"><h1>Rendering with Responses</h1><p>Response objects are what you use to help render your application. They are essentially just a collection of properties related to which route matched the current location. You can pick and choose which ones you need to use when you are rendering. There is no one &quot;correct&quot; way render with a response, but in this guide we will use the response&#x27;s body property and a render function.</p><div class="section" id="properties"><h2>The Properties of a Response Object<a class="header-link" href="/guides/responses/#properties">#</a></h2><pre class="language-javascript">{
  // The location key
  key: &#x27;1.0&#x27;,

  // The location object used to generate the response.
  location: { pathname: &#x27;/photos/6789/12345&#x27;, ... },

  // The status code for the response.
  // This defaults to 200, but can be changed
  // if no routes match or a route issues a redirect.
  status: 200,

  // If the route had a match.response function and called
  // set.data, that value will be set here. If not,
  // this will be undefined.
  data: {...},

  // The title string generated by the route
  // or an empty string if the route has no title property
  title: &#x27;Photo 12345&#x27;,

  // The value returned by the route&#x27;s body function
  body: Photo,

  // The name of the best matching route
  name: &#x27;Photo&#x27;,

  // The name of ancestor routes that matched
  // part of the location&#x27;s pathname
  partials: [&#x27;Album&#x27;],

  // An object containing the values parsed
  // from the pathname by path-to-regexp.
  params: { photoID: 12345, albumID: 6789 },

  // If an error occurs while generating the
  // response, it will be set here
  error: undefined
}</pre><div class="subsection" id="redirect-properties"><h3>Redirect Response<a class="header-link" href="/guides/responses/#redirect-properties">#</a></h3><p>When you redirect, a slightly different response object will be created. You are in charge of actually redirecting, Curi just generates a response that lets you know that you should redirect. You can redirect by using your history object&#x27;s replace (or push) methods, or if you are using one of the library specific Curi packages, there might be a built-in way for you to redirect (e.g. curi-react provides the <code class="language-jsx"><!-- -->&lt;<!-- -->Redirect<!-- -->&gt;</code> component).</p><pre class="language-javascript">{
  // These properties also exist on the redirect response
  key: &#x27;1.0&#x27;,
  location: { pathname: &#x27;/photos/6789/12345&#x27;, ... },
  status: 301,
  data: {...},
  title: &#x27;Photo 12345&#x27;,

  // The redirectTo property provides information on
  // where you should redirect to
  redirectTo: { pathname: &#x27;/login&#x27; }
}</pre></div></div><div class="section" id="body-property"><h2>The Body Property<a class="header-link" href="/guides/responses/#body-property">#</a></h2><p>The body property of a response is the value set by the matched route&#x27;s<!-- --> <code class="language-javascript">match.response</code> function, using <code class="language-javascript">set.body()</code>. This value can be anything you want it to be, but it should usually be a function/component. Here, we will assume that each of your routes have<!-- --> <code class="language-javascript">body</code> properties that return a function.</p><pre class="language-javascript">// we are assuming all routes are setup like this
{
  ...,
  match: {
    response: ({ set }) =&gt; {
      set.body(function() { ... });
    }
  }
}</pre><p>The response&#x27;s <code class="language-javascript">body</code> function should take other response properties as its arguments. Which ones will vary based on your application, but if you are using path parameters, then the<!-- --> <code class="language-javascript">params</code> object should be one of these. If you are doing data loading in your routes (using the<code class="language-javascript">match.every</code> property), then you will probably also want to pass the data property (which is attached to the response in the<!-- --> <code class="language-javascript">match.response</code> function) to your body function.</p><div class="note"><strong>Note:</strong> <!-- -->It is important that each body function has the same argument signature. If you want to play it safe, you can just have each function expect to receive the full response object as an argument.</div><p>As stated above, the body property does not have to be a function. You may want to pass extra data for each route, in which case it might be convenient for the route&#x27;s <code class="language-javascript">set.body</code> call to set the<!-- --> <code class="language-javascript">body</code> as an object. This can be useful if you want to have multiple render functions (where each one would manipulate a different part of your application).</p><pre class="language-javascript">{
  name: &#x27;User&#x27;,
  match: {
    response: ({ set }) =&gt; {
      set.body({
        main: function User() {...},
        menu: function UserMenu() {...}
      });
    }
  }
}</pre></div><div class="section" id="render-function"><h2>The Render Function<a class="header-link" href="/guides/responses/#render-function">#</a></h2><p>A render function is simply a function that receives a response object as its argument and manipulates the DOM (or its equivalent for non-browser environments) using the response. In React or Vue, a render function would trigger a re-rendering of your application. In vanilla JavaScript, a render function would manually update the DOM.</p><div class="subsection" id="rendering-redirects"><h3>Rendering Redirects<a class="header-link" href="/guides/responses/#rendering-redirects">#</a></h3><p>The first thing you should do in your render function is to check if the response has a <code class="language-javascript">redirectTo</code> property. If it does, then you should redirect to the new location instead of rendering.</p><p>curi-react and curi-vue both provide components that will do this for you, but you can also just use your history object to redirect. You will want to use your history&#x27;s replace function to redirect.</p><pre class="language-javascript">function render(response) {
  // assuming that your history object is in scope
  if (response.redirectTo) {
    history.replace(response.redirectTo)
  }
}</pre></div><div class="subsection" id="rendering-HTML"><h3>Rendering HTML<a class="header-link" href="/guides/responses/#rendering-HTML">#</a></h3><p>Once we have verified that we don&#x27;t have to redirect, we are ready to render the content using the response. There is still one thing to verify: that our response actually has a body property. If none of your routes match, then the response will not have a body property. You can rememdy this by adding a wildcard route to the end of your routes array, but this is not necessary. You can also just have a default function that will be used when there is no body property.</p><pre class="language-javascript">// use a wildcard route
const routes = [
  // ...,
  {
    name: &#x27;Not Found&#x27;,
    path: &#x27;(.*)&#x27;
  }
];

// or have a default body function
function render(response) {
  //...
  const body = response.body || function defaultBody() {...}
  body(response.params);
}</pre><p>Now that we have our body function, we just need to call it. The exact behavior will vary based on how you are rendering your application. For a React application, we would just pass the body function to React&#x27;s <code class="language-javascript">createElement</code> function (or use JSX). For vanilla JavaScript, our body function probably returns an HTML string, so we would assign the returned value to the DOM node that holds our application.</p><pre class="language-javascript">// vanilla JavaScript
const root = document.getElementById(&#x27;root&#x27;);

function render(response) {
  // call the body function to return content
  root.innerHTML = response.body(response.params, response.data);
}

// react
function render(response) {
  // This function should be a property of the &lt;CuriBase&gt; and
  // it should return a React element
  const Body = response.body || defaultBody;
  return React.createElement(Body, { params: response.params });
}</pre></div></div><div><h2>Next</h2><p>Let&#x27;s take a moment to go back to our router and look at what Curi&#x27;s add-ons are for in the<!-- --> <a href="/guides/addons/">Using Add-ons</a> <!-- -->guide.</p></div></div><div class="sidebar"><h2>Guides</h2><ul><li class="link-group"><h3>basic</h3><ul class="link-list"><li class="solo"><a href="/guides/installation/">Installation</a></li><li class="solo"><a href="/guides/getting-started/">Getting Started</a></li><li class="solo"><a href="/guides/routes/">All About Routes</a></li><li class="solo"><a class="active" href="/guides/responses/">Rendering with Responses</a></li></ul></li><li class="link-group"><h3>advanced</h3><ul class="link-list"><li class="solo"><a href="/guides/addons/">Using Add-ons</a></li><li class="solo"><a href="/guides/side-effects/">Using Side Effects</a></li><li class="solo"><a href="/guides/response-caching/">Response Caching</a></li><li class="solo"><a href="/guides/code-splitting/">Code Splitting</a></li><li class="solo"><a href="/guides/loading/">Loading Route Data</a></li><li class="solo"><a href="/guides/react/">React Basics</a></li></ul></li><li class="link-group"><h3>migration</h3><ul class="link-list"><li class="solo"><a href="/guides/migrate-rrv3/">Migrate from React Router v2/3 to Curi</a></li></ul></li></ul></div></div></main></div></div>
    <script src="https://unpkg.com/react@16.0.0/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@16.0.0/umd/react-dom.production.min.js"></script>
    <script src="/static/js/prism.js"></script>
    <script src="/static/js/bundle.js"></script>
  </body>
</html>
